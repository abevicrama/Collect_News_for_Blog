{% extends 'blog/base.html' %}
{% load blog_extras %}

{% block content %}
    <div class="container">
        <!-- Main Content Area -->
        <div class="main-content">
            <!-- Section Heading -->
            <div class="section-heading">
                {% if current_category %}
                <h4>Category: {{ current_category }}</h4>
                {% else %}
                <h4>Recent Posts</h4>
                {% endif %}
            </div>

            {% for post in recent_posts %}
            <div class="single-post-area">
                <div class="post-thumbnail">
                    <!-- Use real images based on category -->
                    <img src="{% category_image_url post.category %}" alt="{{ post.title }}">
                </div>
                <div class="post-content">
                    <a href="{% url 'category_posts' post.category %}" class="post-cata cata-{{ post.category|lower }}">{{ post.category }}</a>
                    <a href="{% url 'post_detail' post.id %}" class="post-title">{{ post.title }}</a>
                    <div class="post-meta">
                        <a href="#">By {{ post.author.username }}</a> | 
                        <a href="#">{{ post.publish_date|date:"F d, Y" }}</a>
                    </div>
                </div>
            </div>
            {% endfor %}

            <!-- Pagination -->
            <div class="pagination-area mt-30">
                <nav aria-label="Page navigation">
                    <ul class="pagination">
                        {% if page_obj.has_previous %}
                        <li class="page-item">
                            <a class="page-link" href="?page=1" aria-label="First">
                                <span aria-hidden="true">&laquo;&laquo;</span>
                            </a>
                        </li>
                        <li class="page-item">
                            <a class="page-link" href="?page={{ page_obj.previous_page_number }}" aria-label="Previous">
                                <span aria-hidden="true">&laquo;</span>
                            </a>
                        </li>
                        {% endif %}

                        <li class="page-item active"><a class="page-link" href="#">{{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</a></li>

                        {% if page_obj.has_next %}
                        <li class="page-item">
                            <a class="page-link" href="?page={{ page_obj.next_page_number }}" aria-label="Next">
                                <span aria-hidden="true">&raquo;</span>
                            </a>
                        </li>
                        <li class="page-item">
                            <a class="page-link" href="?page={{ page_obj.paginator.num_pages }}" aria-label="Last">
                                <span aria-hidden="true">&raquo;&raquo;</span>
                            </a>
                        </li>
                        {% endif %}
                    </ul>
                </nav>
            </div>

        </div>

        <!-- Sidebar Area -->
        <div class="sidebar">
            
            <!-- Category Widget -->
            <div class="single-widget">
                <h6 class="widget-title">Categories</h6>
                <ul class="categories-list">
                    {% for cat in category_counts %}
                    <li>
                        <a href="{% url 'category_posts' cat.category %}">
                            <span>{{ cat.category }}</span> 
                            <span>({{ cat.count }})</span>
                        </a>
                    </li>
                    {% endfor %}
                </ul>
            </div>

            <!-- Other Widgets can go here -->

        </div>
    </div>
{% endblock %}
